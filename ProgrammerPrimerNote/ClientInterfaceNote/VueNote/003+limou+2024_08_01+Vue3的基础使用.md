# 1.Vue3 的编码环境

## 1.1.在线环境

*   如果你更喜欢不用任何构建的原始 `HTML`，可以使用 [JSFiddle](https://jsfiddle.net/yyx990803/2ke1ab0z/) 入门
*   如果你已经比较熟悉 `Node.js` 和构建工具等概念，还可以直接在浏览器中打开 [StackBlitz](https://vite.new/vue) 来尝试完整的构建设置

## 1.2.脚架工具

在以前使用 `Vue2` 的时候，我们体验过原生的 `Vue2.js` 代码直接引入 `.html`  来使用，也使用过 `vue` 的第一款脚手架工具 `vue-cli`，这种工具的体验还是相当不错的。

不过我们仅仅需要有 `Vue3.js` 也同样是个 `JS` 库的概念即可，这里不再使用传统的源代码引入和使用老旧的 `vue-cli` 脚手架，而是使用较为现代的 `create-vue`，这个脚手架内部又会默认使用 `vite` 构建工具。

>   [!IMPORTANT]
>
>   补充：`vue-cli` 和 `create-vue` 的区别。
>
>   | 特性         | `create-vue`                         | `Vite`                                              |
>   | ------------ | ------------------------------------ | --------------------------------------------------- |
>   | **功能**     | 项目初始化工具，生成 `Vue3` 项目模板 | 构建工具与开发服务器，提供构建和开发支持            |
>   | **目标**     | 提供 `Vue3` 项目的基础模板和结构     | 提供快速的开发体验与高效的生产构建                  |
>   | **作用**     | 创建 `Vue3` 项目骨架（文件、配置等） | 处理项目的构建、开发、热重载等                      |
>   | **使用场景** | 用于创建一个新的 `Vue3` 项目         | 用于开发和构建 `Vue3` 项目，并且也支持 `React` 项目 |
>
>   另外，在没有 `Vite` 之前，许多前端项目是依赖 `Webpack` 来进行模块打包、构建、优化的。

## 1.3.语法选择

本文档选择的是 `vue3` 的组合式语法。

# 2.Vue3 的首个应用

我们先使用 `create-vue` 来建立第一个应用，这个应用会打开一个关于 `vue` 的页面，首先需要下载脚手夹，然后进行配置。

```shell
# 安装脚手架并且配置应用
$ npm create vue@latest
Need to install the following packages:
create-vue@3.12.0
Ok to proceed? (y) y


> npx
> create-vue


Vue.js - The Progressive JavaScript Framework

✔ 请输入项目名称： … vue3-test
✔ 是否使用 TypeScript 语法？ … 否 / 是
✔ 是否启用 JSX 支持？ … 否 / 是
✔ 是否引入 Vue Router 进行单页面应用开发？ … 否 / 是
✔ 是否引入 Pinia 用于状态管理？ … 否 / 是
✔ 是否引入 Vitest 用于单元测试？ … 否 / 是
✔ 是否要引入一款端到端（End to End）测试工具？ › 不需要
✔ 是否引入 ESLint 用于代码质量检测？ › 是
✔ 是否引入 Prettier 用于代码格式化？ … 否 / 是
✔ 是否引入 Vue DevTools 7 扩展用于调试? (试验阶段) … 否 / 是

正在初始化项目 /home/ljp/test/vue3test/vue3-test...

项目初始化完成，可执行以下命令：

  cd vue3-test
  npm install
  npm run format
  npm run dev

npm notice
npm notice New minor version of npm available! 10.7.0 -> 10.9.0
npm notice Changelog: https://github.com/npm/cli/releases/tag/v10.9.0
npm notice To update run: npm install -g npm@10.9.0
npm notice

```

按照上面的指令来初始化项目。

```shell
# 初始化项目并且运行
# 打开项目主目录
$ cd vue3-test
# 安装项目依赖
$ npm install

added 139 packages, and audited 140 packages in 13s

36 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

# 运行代码格式化
$ npm run format

> vue3-test@0.0.0 format
> prettier --write src/

src/App.vue 54ms (unchanged)
src/assets/base.css 7ms (unchanged)
src/assets/main.css 2ms (unchanged)
src/components/HelloWorld.vue 12ms (unchanged)
src/components/icons/IconCommunity.vue 2ms (unchanged)
src/components/icons/IconDocumentation.vue 1ms (unchanged)
src/components/icons/IconEcosystem.vue 2ms (unchanged)
src/components/icons/IconSupport.vue 1ms (unchanged)
src/components/icons/IconTooling.vue 2ms (unchanged)
src/components/TheWelcome.vue 8ms (unchanged)
src/components/WelcomeItem.vue 5ms (unchanged)
src/main.js 2ms (unchanged)

# 修改配置(可选, 如果您是直接在自己本机的桌面操作系统安装, 则可以跳过这个步骤, 因为我是使用云服务器, 必须更改部署地址和部署端口才能看到界面)
$ ls
eslint.config.js  index.html  jsconfig.json  node_modules  package.json  package-lock.json  public  README.md  src  vite.config.js
$ vim vite.config.js 
$ cat vite.config.js 
import { fileURLToPath, URL } from 'node:url'

import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

// https://vite.dev/config/
export default defineConfig({
  plugins: [
    vue(),
  ],
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    },
  },
  server: {
    host: '0.0.0.0', // 修绑定在任意 ip 地址
    port: 8081, // 修改开放的 port 端口
  }
})

# 开放端口号
$ sudo ufw allow 8081
规则已添加
规则已添加 (v6)

# 运行项目
$ npm run dev
  VITE v5.4.10  ready in 154 ms

  ➜  Local:   http://localhost:8081/
  ➜  Network: http://10.1.74.26:8081/
  ➜  press h + enter to show help
```

在浏览器打开上面网址（本地开发使用第一个第二个都可以，远程开发只能使用第二个）。

![image-20241108093125400](./assets/image-20241108093125400.png)

这里稍微解释一些重要的文件。

首先是配置文件，由于我们的项目使用了 `vite` 构建工具，所以有这个配置文件。

```js
// vite.config.js: vite 配置文件
import { defineConfig } from "vite";
import vue from "@vitejs/plugin-vue";
import { resolve } from "path";
import AutoImport from "unplugin-auto-import/vite";
import Components from "unplugin-vue-components/vite";
import { ElementPlusResolver } from "unplugin-vue-components/resolvers";

// https://vite.dev/config/
export default defineConfig({
  plugins: [
    vue(),
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
  resolve: {
    alias: {
      "@": resolve(__dirname, "./src"), // 设置 @ 缩写方便引入文件
    },
  },
  server: {
    host: "127.0.0.1", // 或指定为具体的 IP 地址
    port: 8003, // 设置为所需的端口号
  },
});

```

挂载页面文件，需要定义挂载点和引入 `JS` 代码（创建了根组件），而 `JS` 代码内部引入了描述主页的 `.vue` 文件。

```html
<!-- index.html: 应用挂载文件 -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + Vue</title>
  </head>
  <body>
    <div id="app"></div> <!--定义挂载点: 后续 Vue 应用会挂载到这里 -->
    <script type="module" src="/src/main.js"></script> <!-- 设置入口文件: 一个 Vue 应用的所有 JS 代码 -->
  </body>
</html>

```

```js
// @/main.js: 创建一个 Vue 应用实例
import { createApp } from "vue";
import "./style.css";
import App from "./App.vue";

createApp(App).mount("#app");

```

```vue
<!-- @/App.vue: 描述主页应用, 该页面通常设置页面路由组件 -->
<script setup></script>

<template>
  <div>
    <p>你好我是主页</p>
  </div>
</template>

<style scoped></style>

```

> [!IMPORTANT]
>
> 补充：`Vue2` 和 `Vue3` 在 `.vue` 文件上的书写区别。
>
> 在 `Vue3` 中，`setup` 和 `scoped` 是两个重要的概念，分别与 `Vue` 组件的逻辑和样式作用域相关。
>
> 1. `<script setup>` 是 `Vue3` 引入的一个编译时语法糖，用于简化组件的编写。它用于在 `<script>` 标签中声明组件的逻辑，且具有以下作用。
>
>    - **简化组件编写**：通过使用 `<script setup>`，`Vue` 自动处理常见的功能，如响应式数据、生命周期钩子等，无需手动引入 `defineComponent` 组件。
>    - **更直接的组合式 API 使用**：可以直接在 `<script setup>` 中使用 `Vue3` 的组合式 `API`（例如 `ref`, `reactive`, `computed`, `watch` 等），不需要额外的声明。
>
>    例如，在 `<script setup>` 中声明一个响应式变量：
>
>    ```vue
>    <script setup>
>    import { ref } from 'vue';
>    const message = ref('你好我是主页');
>    </script>
>
>    <template>
>      <div>
>        <p>{{ message }}</p>
>      </div>
>    </template>
>    ```
>
>    简化后的 `setup` 语法使得 `Vue` 组件更简洁且易于阅读和维护。
>
> 2. `<style scoped>` 是 `Vue3` 用于限定样式作用域的一个特性。它确保在该 `<style>` 标签中的样式只作用于当前组件的元素，而不会影响全局或其他组件。通过 `scoped`，可以防止样式泄漏到外部，避免全局样式污染。例如，当您在组件中写 `CSS` 时，`scoped` 会自动为每个元素添加一个独特的属性，确保它们仅在当前组件内生效。
>
>    ```vue
>    <style scoped>
>    p {
>      color: red;
>    }
>    </style>
>    ```
>
>    这个样式只会应用到当前组件的 `<p>` 元素，而不会影响其他组件的 `<p>` 元素。

> [!IMPORTANT]
>
> 补充：值的注意的是，在根组件自带的 `innerHTML` 也是组件模板的一部分，在组件没有设置 `template` 选项时，`Vue` 组件就会自动使用 `innerHTML` 作为模板。

> [!IMPORTANT]
>
> 补充：这个配置指的是在 `Vue` 应用实例 (`app`) 创建后但挂载之前所进行的所有应用级配置。这种配置通常是用来设定一些全局性的选项，比如错误处理器、全局组件、插件、全局指令等，体现为创建好后的应用实例在没有挂载之前可以使用 `app.use()` 或 `app.component()` 或 `app.config.errorHandler` 等。要确保在调用 `app.mount('#app')` 之前完成这些配置，因为挂载后配置将不会生效。 

> [!IMPORTANT]
>
> 补充：服务端渲染可以考虑挂载多个 `Vue` 应用实例。

我们后面都通过 `App.vue` 文件来演示 `Vu3` 的语法。

# 3.Vue3 的模板语法

- `{{}}` 会将定义好的数据值解释为纯文本

- `v-html` 给一个 `<div>` 或 `<span>` 定义一个则会渲染指定 `HTML` 文本（不过注意，为了避免 `XSS` 漏洞，慎用这个指令）

  ```vue
  <!-- @/App.vue: 描述主页应用, 这个页面通常会设置页面路由组件 -->
  <script setup>
  import { ref } from "vue";
  const rawHtml = ref("<strong>Bold text</strong>");
  </script>
  
  <template>
    <div>
      <p>你好我是主页</p>
      <!-- 不会渲染 -->
      <p>{{ rawHtml }}</p>
      <!-- 会渲染 -->
      <p><span v-html="rawHtml"></span></p>
    </div>
  </template>
  
  <style scoped></style>
  
  ```

- `v-bind` 由于双大括号不能在标签属性中使用，因此就用这个指令替代 `{{}}` 给组件的某些属性赋予数据值（简写语法为 `:`，后面只需要带上参数即可），并且这个值了还可以绑定组合起来的数据（有点像类）

  ```vue
  <!-- @/App.vue: 描述主页应用, 这个页面通常会设置页面路由组件 -->
  <script setup>
  const objectOfAttrs = {
    id: "container",
    class: "wrapper",
    style: "background-color:green",
  };
  </script>
  
  <template>
    <div>
      <p>你好我是主页</p>
      <div v-bind="objectOfAttrs"></div>
    </div>
  </template>
  
  <style scoped></style>
  
  ```

- 在 `Vue` 模板内，`JS` 表达式/`JS` 函数可以被使用在如下场景上：

  - 在文本插值中 (双大括号)

  - 在任何 `Vue` 指令 (以 `v-` 开头的特殊 `attribute`) `attribute` 的值中

    ```vue
    {{ number + 1 }}
    
    {{ ok ? 'YES' : 'NO' }}
    
    {{ message.split('').reverse().join('') }}
    
    <div :id="`list-${id}`"></div>
    ```

  - 仅支持单一表达式 ，不支持语句（必须可以被求值的 `JS` 代码）

    ```js
    <!-- 这是一个语句，而非表达式 -->
    {{ var a = 1 }}
    
    <!-- 条件控制也不支持，请使用三元表达式 -->
    {{ if (ok) { return message } }}
    ```

- `v-if:"布尔变量"` 用于条件渲染元素（注意和用于禁用的 `v-bind:disabled="布尔变量"` 有区别）

- `v-on:填入DOM事件="调用方法名称"` 将监听 `DOM` 事件，调用对应的事件方法（`v-on` 缩写为 `@`）

- 前面我们提到过 `v-bind:` 后是一个参数，不过这个参数是静态参数，我们还可以使用 `[]` 语法将参数包裹起来填写动态参数（类似 `v-bind:[]` 的其他指令也有类似的，比如 `v-on:[]`）

  - 动态参数值的限制：动态参数中表达式的值应当是一个字符串，或者是 `null`。特殊值 `null` 意为显式移除该绑定。其他非字符串的值会触发警告。
  - 动态参数语法限制：动态参数表达式因为某些字符的缘故有一些语法限制，比如空格和引号，在 `HTML attribute` 名称中都是不合法的。

- 修饰符...

# 4.Vue3 的响应基础

- 在组合式 `API` 中，推荐使用 `ref()` 函数来声明响应式状态

  ```js
  <!-- @/App.vue: 描述主页应用, 这个页面通常会设置页面路由组件 -->
  <script setup>
  import { ref } from "vue";
  
  const count = ref(0);
  
  console.log(count); // { value: 0 }
  console.log(count.value); // 0
  
  count.value++;
  console.log(count.value); // 1
  </script>
  
  <template>
    <div>
      <p>你好我是主页</p>
    </div>
  </template>
  
  <style scoped></style>
  
  ```

- 

# 5.Vue3 的计算属性



# 6.Vue3 的样式绑定



#  7.Vue3 的逻辑渲染



# 8.Vue3 的事件处理



# 9.Vue3 的表单绑定



# 10.Vue3 的生命周期



# 11.Vue3 的侦听观察



# 12.Vue3 的模板引用



# 13.Vue3 的组件封装



# 14.Vue3 的工程规范



# 15.Vue3 的进阶主题





