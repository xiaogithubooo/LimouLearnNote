# 1.QWidget

了解控件是学习 `Qt` 的重要部分，窗口、按钮、文本框、单选按钮、复选按钮、下拉框都可以被称为控件或小组件（`Widget`），控件时构成一个图形化界面的基本要素。`Qt` 自带很多的基本控件，还支持程序员对现有控件做拓展，甚至直接自定义出新的控件。

而大部分的控件在 `Qt` 的 `Qt Creator` 界面设计页面中都有展示出来，但是 `Qt` 的默认样式颜值比较一般，但是后来的 `Qt Design Studio` 制作出来的界面程序很接近于现代界面设计，但是目前收费（而且和我们学的基本 `Qt` 知识还有些许区别）。

并且，所有的基本控件类都是继承自 `QWidget{/*...*/};`，可以在界面设计页面中进行查看和修改。

![image-20240428193514029](./assets/image-20240428193514029.png)

| 属性                      | 作用                                                         |
| ------------------------- | ------------------------------------------------------------ |
| **enabled**               | 设置控件是否可使用，`true` 表示可用，`false` 表示禁用。所谓的禁用实际上就是无法接受用户的任何输入事件，外观上通常显示为灰色，而且控件对象的子控件也会被禁用。 |
| **geometry**              | 位置和尺寸，包含 `x、y、width、height` 四个部分，坐标是以父元素为参考进行设置的（前两者描述控件的坐标，后两者描述控件的尺寸）。 |
| **windowTitle**           | 设置 `widget` 标题。                                         |
| **windowIcon**            | 设置 `widget` 图标。                                         |
| **windowOpacity**         | 设置 `widget` 透明度。                                       |
| **cursor**                | 鼠标悬停时显示的图标形状，在 `Qt Designer` 界面中可以清楚看到可选项。 |
| **font**                  | 字体相关属性，涉及到字体家族、字体大小、粗体、斜体、下划线等样式。 |
| **toolTip**               | 鼠标悬停在 `widget` 上会在状态栏中显示的提示信息。           |
| **toolTipDuring**         | `toolTip` 显示的持续时间。                                   |
| **statusTip**             | `Widget` 状态发生改变时显示的提示信息(比如按钮被按下等)。    |
| **whatsThis**             | 鼠标悬停并按下 `[alt+F1]` 时，显示的帮助信息(显示在一个弹出的窗口中)。 |
| **styleSheet**            | 允许使用 `CSS` 来设置 `widget` 中的样式。`Qt` 中支持的样式非常丰富，对于前端开发人员上手是非常友好的。 |
| **focusPolicy**           | 控件如何获取焦点。                                           |
| **contextMenuPolicy**     | 上下文菜单的显示策略。                                       |
| **locale**                | 设置语言和国家地区。                                         |
| **acceptDrops**           | 部件是否接受拖放操作。                                       |
| **minimumSize**           | 控件的最小尺寸。包含最小宽度和最小高度。                     |
| **maximumSize**           | 控件的最大尺寸。包含最大宽度和最大高度。                     |
| **sizePolicy**            | 尺寸策略。设置控件在布局管理器中的缩放方式。                 |
| **windowModality**        | 指定窗口是否具有 "模态" 行为。                               |
| **sizeIncrement**         | 拖动窗口大小时的增量单位。                                   |
| **baseSize**              | 窗口的基础大小，用来搭配 sizeIncrement 调整组件尺寸时计算组件应该调整到的合适的值。 |
| **palette**               | 调色板。可以设置 widget 的颜色风格。                         |
| **mouseTracking**         | 是否跟踪鼠标移动事件。                                       |
| **tabletTracking**        | 是否跟踪触摸屏的移动事件。                                   |
| **layoutDirection**       | 布局方向。                                                   |
| **autoFillBackground**    | 是否自动填充背景颜色。                                       |
| **windowFilePath**        | 将 widget 与一个本地文件路径关联起来。                       |
| **accessibleName**        | 设置 widget 的可访问名称。                                   |
| **accessibleDescription** | 设置 widget 的详细描述。                                     |
| **inputMethodHints**      | 针对输入框有效，用来提醒用户当前能输入的合法数据的格式。比如只能输入数字、只能输入日期等。 |

## 1.1.使能

另外还有一系列的方法：

-   `isEnabled()`：获取控件的可用状态
-   `setEnabled()`：设置控件的可用状态

```cpp
//widget.h
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>
#include <QPushButton>

QT_BEGIN_NAMESPACE
namespace Ui { class Widget; }
QT_END_NAMESPACE

class Widget : public QWidget
{
    Q_OBJECT

public:
    Widget(QWidget *parent = nullptr);
    ~Widget();

public:
    void Handle(QPushButton* button);

private:
    Ui::Widget *ui;
};
#endif // WIDGET_H

```

```cpp
//widget.cpp
#include "widget.h"
#include "ui_widget.h"
#include <QPushButton>
#include <QDebug>

Widget::Widget(QWidget *parent)
    : QWidget(parent)
    , ui(new Ui::Widget)
{
    ui->setupUi(this);

    QPushButton* button = new QPushButton(this);
    button->setText("按钮");
    connect(button, &QPushButton::clicked, this, [=](){
        Handle(button);
    });
}

Widget::~Widget()
{
    delete ui;
}

void Widget::Handle(QPushButton* button)
{
    qDebug() << "Handle()\n";
    button->setEnabled(false);
}

```

上面代码就可以在按钮点击后，取消对按钮的使能。

## 1.2.位置和尺寸

-   `geometry()`：则可以获取控件的位置和尺寸，返回结果就是四元素的 `QRect`，也就是一个矩形对象
-   `setGeometry(QRect)` 和 `setGeometry(int x, int y, int width, int height)`：设置控件的位置和尺寸，直接设置一个 `QRect` 或者分成四个属性单独设置

>   补充：`Qt` 还对各种几何图形所需要的属性进行了抽象，产生了各种轻小的几何类。

我们直接拖拽出五个按钮控件，分别命名转到槽进行设置。

![image-20240428211720786](./assets/image-20240428211720786.png)

```cpp
//widget.h
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>
#include <QPushButton>

QT_BEGIN_NAMESPACE
namespace Ui { class Widget; }
QT_END_NAMESPACE

class Widget : public QWidget
{
    Q_OBJECT

public:
    Widget(QWidget *parent = nullptr);
    ~Widget();

private slots:
    void on_pushButton_up_clicked();

    void on_pushButton_left_clicked();

    void on_pushButton_right_clicked();

    void on_pushButton_down_clicked();

private:
    Ui::Widget *ui;
};
#endif // WIDGET_H

```

```cpp
//widget.cpp
#include "widget.h"
#include "ui_widget.h"
#include <QDebug>

Widget::Widget(QWidget *parent)
    : QWidget(parent)
    , ui(new Ui::Widget)
{
    ui->setupUi(this);
}

Widget::~Widget()
{
    delete ui;
}

void Widget::on_pushButton_up_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    rect.setY(rect.y() - 5); //这里只是对矩形对象本身做了修改, 该对象只是对控件的拷贝
    ui->pushButton_target->setGeometry(rect);
    qDebug() << rect;
}

void Widget::on_pushButton_left_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    rect.setX(rect.x() - 5);
    ui->pushButton_target->setGeometry(rect);
    qDebug() << rect;
}

void Widget::on_pushButton_right_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    rect.setX(rect.x() + 5);
    ui->pushButton_target->setGeometry(rect);
    qDebug() << rect;
}

void Widget::on_pushButton_down_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    rect.setY(rect.y() + 5);
    ui->pushButton_target->setGeometry(rect);
    qDebug() << rect;
}

```

但是上述指修改了 `x、y` 能否保持尺寸不变呢？可以进一步修改代码。

```cpp
//widget.cpp
#include "widget.h"
#include "ui_widget.h"
#include <QDebug>

Widget::Widget(QWidget *parent)
    : QWidget(parent)
    , ui(new Ui::Widget)
{
    ui->setupUi(this);
}

Widget::~Widget()
{
    delete ui;
}

void Widget::on_pushButton_up_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    //rect.setY(rect.y() - 5); //这里只是对矩形对象本身做了修改, 该对象只是对控件的拷贝
    //ui->pushButton_target->setGeometry(rect);

    ui->pushButton_target->setGeometry(rect.x(), rect.y() - 5, rect.width(), rect.height());

    qDebug() << rect;
}

void Widget::on_pushButton_left_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    //rect.setX(rect.x() - 5);
    //ui->pushButton_target->setGeometry(rect);

    ui->pushButton_target->setGeometry(rect.x() - 5, rect.y(), rect.width(), rect.height());

    qDebug() << rect;
}

void Widget::on_pushButton_right_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    //rect.setX(rect.x() + 5);
    //ui->pushButton_target->setGeometry(rect);

    ui->pushButton_target->setGeometry(rect.x() + 5, rect.y(), rect.width(), rect.height());

    qDebug() << rect;
}

void Widget::on_pushButton_down_clicked()
{
    //获取 target 本身的 geometry
    QRect rect = ui->pushButton_target->geometry();
    //rect.setY(rect.y() + 5);
    //ui->pushButton_target->setGeometry(rect);

    ui->pushButton_target->setGeometry(rect.x(), rect.y() + 5, rect.width(), rect.height());

    qDebug() << rect;
}

```

![recording](./assets/recording.gif)

